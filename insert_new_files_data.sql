-- =====================================================
-- INSERT NEW FILES DATA
-- ุฅุถุงูุฉ ุงููููุงุช ุงูุฌุฏูุฏุฉ ูุฌุฏูู files
-- =====================================================

BEGIN;

-- ุฅุฏุฑุงุฌ ุงููููุงุช ุงูุฌุฏูุฏุฉ
INSERT INTO public.files (title, description, category, file_url, file_size, downloads) VALUES

-- 1. ููู ุจุตูุฌุฉ ุขููู
(
    'ุจุตูุฌุฉ ุขููู ( ุจุตูุฌ ุจุดูุงูุฉ )',
    'ุจููุฏูููู ููู ุจุตูุฌุฉ ุขููู ( ุจุตูุฌ ุจ ุดูุงูุฉ ุณุงุจูุง ) ๐ถโค๏ธ

ูุฑุจูุง ูููููู ูุง ุดุจุงุจ ูุจูุจูู ููููุนุด ุชุจุตูุฌ ูู ุบูุฑ ูุง ุชููู ูุงูู',
    'verbal',
    'https://drive.google.com/file/d/1nigAlfxIBRQk2JxjXaHHfk4Cnky3SqhQ/view?usp=sharing',
    '3.6 MB',
    0
),

-- 2. ููู ููุฎุต ุงููุทุน
(
    'ููุฎุต ุงููุทุน',
    'ู ุงุฎูุฑุงุงุงุงุงุงุง ุฎูุตูุง ููู ูู ุฃุฌูุฏ ุงููููุงุช ุงูุนูููุงูุง ุงู ุฃุฌูุฏูู ูุนูุงโก๏ธโก๏ธ

ุงูููู ุงููู ููุญู ูุนุงู ูุดููุฉ ุงูุฃุณุชูุนุงุจ ุจุดูู ูุงููโก๏ธ๐ซฃ

ุฌูุนูุง ููู ุงููุทุน ุงูุตุนุจู ู ุชู ุชูุฎูุตูุง ู ุดุฑุญูุง ุจุดูู ููุตู ูุน ุดููู ุฌูู ู ุตูุฑ ููุจุตูุฌู ูุนูู ูุชุฌูุจ ุงูุฃุณุชูุนุงุจ ูู ุดูุงู๐ซต๐ป

ุงูููู ูุญูู ููุท ูููุดุชุฑููู ุจุฏูุฑุฉ ูุณุชุฑ ุฅููุงุจ ุนุจุฏ ุงูุนุธูู๐ซก',
    'verbal',
    'https://drive.google.com/file/d/1jcwCdudm0CBaCHCtmcKf64MCBb_HQB-E/view?usp=sharing',
    '900 KB',
    0
),

-- 3. ููู ุงูุนูุงูุงุช
(
    'ููู ุงูุนูุงูุงุช',
    'ุงูููู ุบูุฑ ูุญูู ูุบูุฑ ุงููุดุชุฑููู ุจุฏูุฑุฉ
ุฃ/ุงููุงุจ ุนุจุฏุงูุนุธููโผ๏ธ',
    'verbal',
    'https://drive.google.com/file/d/14O_uIGONJUJIY09S_G0dsIqC2JrNTXwP/view?usp=sharing',
    '2.0 MB',
    0
),



ON CONFLICT DO NOTHING;

-- ุงูุชุญูู ูู ุฅุฏุฑุงุฌ ุงูุจูุงูุงุช ุจูุฌุงุญ
DO $$
DECLARE
    file_count INTEGER;
BEGIN
    SELECT COUNT(*) INTO file_count FROM public.files
    WHERE title IN (
        'ุจุตูุฌุฉ ุขููู ( ุจุตูุฌ ุจุดูุงูุฉ )',
        'ููุฎุต ุงููุทุน',
        'ููู ุงูุนูุงูุงุช'
    );

    RAISE NOTICE 'ุชู ุฅุฏุฑุงุฌ % ูููุงุช ุฌุฏูุฏุฉ ุจูุฌุงุญ', file_count;

    IF file_count >= 3 THEN
        RAISE NOTICE 'ุฌููุน ุงููููุงุช ุงูู 3 ุชู ุฅุฏุฑุงุฌูุง ุจูุฌุงุญ โ';
    ELSE
        RAISE WARNING 'ุจุนุถ ุงููููุงุช ูู ูุชู ุฅุฏุฑุงุฌูุง - ุชุญูู ูู ูุฌูุฏ ูููุงุช ููุฑุฑุฉ';
    END IF;
END $$;

-- ุนุฑุถ ุงููููุงุช ุงููุถุงูุฉ ููุชุฃููุฏ
SELECT
    id,
    title,
    category,
    file_size,
    downloads,
    created_at
FROM public.files
WHERE title IN (
    'ุจุตูุฌุฉ ุขููู ( ุจุตูุฌ ุจุดูุงูุฉ )',
    'ููุฎุต ุงููุทุน',
    'ููู ุงูุนูุงูุงุช'
)
ORDER BY created_at DESC;

COMMIT;
